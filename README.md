# Problem ht09-1: ht09-1

Напишите программу, которая генерирует случайные числа. Программа должна состоять из нескольких файлов с исходным кодом (см. далее). Для компиляции программы должен использоваться Makefile. Скомпилированная программа должна называться printrandom.

Все реализации генераторов случайных чисел должны быть вкомпилированы в исполняемый файл. Сам исполняемый файл можно открыть с помощью вызова

    handle = dlopen(NULL, RTLD_LAZY);
Предварительно он должен быть скомпонован с использованием опции -rdynamic.

В Makefile в рецептах компиляции и компоновки должны использоваться переменные CC, LD, CFLAGS, LDFLAGS, причем переопределение CFLAGS и LDFLAGS не должно ломать компиляцию. Это значит, что опции, необходимые для компиляции и компоновки не должны определяться в CFLAGS и LDFLAGS.

Интерфейс генератора случайных чисел
Определите тип RandomSource, который будет реализовывать генерацию равномерно распределенных случайных чисел на отрезке [0;1).

Для работы с этим типом определены две функции:

RandomSource *destroy(RandomSource *src);
double next(RandomSource *src);
Функция next возвращает следующее значение. Функция destroy освобождает ресурсы, используемые в объекте src, включая сам объект. Функция всегда возвращает NULL.

Для хранения указателей на функции работы с RandomSource определяется тип RandomSourceOperations с полями destroy и next именно в этом порядке.

Чтобы работать с объектом типа RandomSource в этом типе определяется поле ops, являющееся указателем на RandomSourceOperations. Использование выглядит примерно так:

    RandomSource *rr;
    // ... создание объекта rr
    double val = rr->ops->next(rr);  // получение очередного числа
    // ...
    rr = rr->ops->destroy(rr); // уничтожаем объект
Для создания объектов типа RandomSource должна использоваться фабрика объектов. В нашем случае это будет функция вида

RandomSource *random_factory(const char *params);
Имя функции может варьироваться, собственно, от этого и зависит, какой реальный генератор случайных чисел будет использоваться.

Необходимые типы данных должны находиться в заголовочном файле random_source.h.

## Генератор 1. Линейный конгруэнтный генератор

Реализуйте линейный конгруэнтный генератор псевдослучайных чисел (Linear congruential generator) с мультипликатором (a) 1103515245, инкрементом (c) 12345 и модулем 2^31.

Фабрика объектов этого типа должна называться random_linear_factory. В качестве параметра передаётся строка, содержащая начальное значение генератора (seed). Это должно быть положительное целое число, у которого в качестве затравки берется младшие 31 бит.

Реализация должна находиться в файле linear.c.

## Генератор 2. Использование источника случайных чисел

Этот генератор должен использовать специальное устройство /dev/urandom, считывая оттуда за раз 64 бита и приводя их к интервалу [0,1). Файл должен быть открыт один раз при создании объекта.

Фабрика объектов этого типа должна называться random_random_factory. Параметр функции-фабрики не используется.

Реализация должна находиться в файле random.c.

Основная программа
Программа принимает в аргументах командной строки

Строку-тип генератора случайных чисел (random или linear)
Количество чисел - целое число от 0 до 100000.
Строку, которая без изменений передаётся в фабрику создания класса.
Программа должна создать указанный в аргументе командной строки генератор случайных чисел, передавая в него аргумент-строку для инициализации. Затем программа должна вывести на стандартный поток вывода требуемое количество случайных чисел. Для вывода одного числа используйте форматное преобразование %.10g.

Для получения адреса функции в коде используйте функцию dlsym.
